<html>
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="app.css">
	<script src="http://d3js.org/d3.v4.min.js"></script>
	<script src="https://d3js.org/d3-color.v1.min.js"></script>
	<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>
	<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/stats.js/r14/Stats.min.js"></script>
    <script src="noframework.waypoints.min.js"></script>
    <title>Cincity</title>
  </head>
  <body>
    <div id="outerHUD">
        <input type="text" placeholder="Search for movie..." id="searchBar">
        <div id="HUD">
            <div id="movieinfo">
                <div id="closebutton">&#x2716;</div>
                <img id="movieImage"></img>
                <div id="HUDcontainer">
                    <div class="HUDtextline">
                        <span id="movieTitle"></span>
                        <span id="movieYear"></span>
                        <span id="movieDirector"></span>
                    </div>
                    <div class="HUDtextline">
                        <span id="movieSynopsis"></span>
                    </div>
                    <div class="HUDtextline">
                        <div class="secondInfoLine">
                            <span id="movieTime"></span><span class="labelDesc"> min</span>
                            <span class="movieInfoLabel">Running time</span>
                        </div>
                        <div class="secondInfoLine">
                            <span id="movieGenre"></span>
                            <span class="movieInfoLabel">Genre</span>
                        </div>
                        <div class="secondInfoLine">
                            <img id="HUDflag"></img>
                            <span class="movieInfoLabel">Country of origin</span>
                        </div>
                    </div>
                    <div class="HUDtextline">
                        <div class="thirdInfoLine">
                            <span id="movieAverage"></span><span class="labelDesc"> /5</span>
                            <span class="movieInfoLabel">Average rating</span>
                        </div>
                        <div class="thirdInfoLine">
                            <span id="movieTotal"></span>
                            <span class="movieInfoLabel">Total ratings</span>
                        </div>
                    </div>
                </div>
            </div>
            <div id="HUDcontent">
            </div>
        </div>
    </div>
    <div id="canvasContainer">
        <canvas id="mainCanvas"></canvas>
        <canvas id="hiddenCanvas"></canvas>
        <div class="tooltip">
            <div class="tooltipContent">
                <div class="tooltipName"></div>
                <div class="tooltipYear"></div>
                <div class="tooltipDirector"></div>
                <div class="tooltipGenre"></div>
                <div class="tooltipAlert"></div>
            </div>
        </div>
    </div>
    
    
    <div class="legend"></div>
    <div id="labelButtonContainer">
        <div class="labelButton" selected="true">Action</div>
        <div class="labelButton" selected="true">Adventure</div>
        <div class="labelButton" selected="true">Animation</div>
        <div class="labelButton" selected="false">Anthology</div>
        <div class="labelButton" selected="true">Avant-Garde</div>
        <div class="labelButton" selected="false">Biography</div>
        <div class="labelButton" selected="true">Comedy</div>
        <div class="labelButton" selected="false">Commercial</div>
        <div class="labelButton" selected="true">Crime</div>
        <div class="labelButton" selected="false">Cult</div>
        <div class="labelButton" selected="true">Documentary</div>
        <div class="labelButton" selected="true">Drama</div>
        <div class="labelButton" selected="false">Erotica</div>
        <div class="labelButton" selected="false">Fantasy</div>
        <div class="labelButton" selected="false">Family</div>
        <div class="labelButton" selected="false">Film noir</div>
        <div class="labelButton" selected="false">Gay & Lesbian</div>
        <div class="labelButton" selected="false">History</div>
        <div class="labelButton" selected="false">Horror</div>
        <div class="labelButton" selected="false">Music</div>
        <div class="labelButton" selected="false">Musical</div>
        <div class="labelButton" selected="true">Music Video</div>
        <div class="labelButton" selected="false">Mystery</div>
        <div class="labelButton" selected="true">Romance</div>
        <div class="labelButton" selected="false">Sci-Fi</div>
        <div class="labelButton" selected="true">Short</div>
        <div class="labelButton" selected="false">Silent</div>
        <div class="labelButton" selected="false">Sport</div>
        <div class="labelButton" selected="true">Thriller</div>
        <div class="labelButton" selected="false">TV Mini-series</div>
        <div class="labelButton" selected="false">TV Movie</div>
        <div class="labelButton" selected="false">War</div>
        <div class="labelButton" selected="false">Western</div>
    </div>
    <form>
        <div class="checkboxContainer">
            <input type="checkbox" id="hideUnlabeled" checked>Only show selected genres</input>
        </div>
        <div class="checkboxContainer">
            <input type="checkbox" id="showCountries">Show country flags</input>
        </div>
    </form>
    <div id="textContainer">
        <div class="para"> 
            <div class="headline">Abstract</div>
            <div class="paratext">
                Movie services such as Netflix and Hulu know the cinematic tastes of millions of their users through their movie watching/rating habits and these patterns are used to recommend movies to their userbase. One such method used to recommend movies is called collaborative filtering. Collaborative filtering yields a matrix of movies-users with each cell representing a user’s likely affinity to a movie. For the purpose of this project, we tried to visualize what such a recommendation system looks like. Such a matrix can be visualized using a technique known as t-Distributed Stochastic Neighbor Embedding (Laurens van der Maaten and Geoffrey Hinton)
            </div>
        </div>
        <div class="para"> 
            <div class="headline">Dataset</div>
            <div class="paratext">
                MUBI is an online service that integrates a subscription video-on-demand service with a massive database of movies from all over the world. Its 8 million users have collectively rated thousands of movies present in its database. 
            </div>
        </div>
        <div class="para"> 
            <div class="headline" id="helloThere">Collecting Data</div>
            <div class="paratext">
                Movie ratings for all users with public profiles were collected through public endpoints on the MUBI API using a multi-threaded Python script. The resulting dataset contained well over a million users. This number was filtered down to a subset of users who had rated at least a certain number of movies.  Metadata for all movies (such as film name, year of release, director name and cast) was scraped from the MUBI film database using beautifulsoup
            </div>
        </div>
        <div class="para"> 
            <div class="headline">Visualization</div>
            <div class="paratext">
                t-SNE is a technique that can be used to reduce high dimensionality data down to two dimensions, such as x and y coordinates, which enables a cluster visualization. This technique performs well at clustering local aspects of underlying data and we were excited to see some interesting patterns emerge out of the resulting visualization
            </div>
        </div>
        <div class="para"> 
            <div class="headline">Under the hood</div>
            <div class="paratext">
                The goal of the project was to create a playful interactive experience that was interesting to a technical and non-technical audience alike. While cookie-cutter libraries for t-SNE visualizations exist, none of them provide mechanics for such interactions. Further, an interactive visualization of this scale (29,000 nodes) requires optimizations that would otherwise slow a browser down. A majority of the code for this visualization was this made from the ground-up and can hopefully be open sourced in the near-future for the good of the community. Some highlights— i. Canvas was chosen over SVGs because of superior performance at scale ii. Dual canvases, one of them a hidden canvas that implements interactions (since events cannot be bound to pixels in a bitmap) iii. Semantic zooming that enables easy viewing at a low zoom level and more granular view at high zoom levels iv. Mouse interactions for each node that reveal something about the underlying data
            </div>
        </div>
    </div>
    <script type="text/javascript" src="ListNode.js"></script> 
    <script type="text/javascript" src="movieObject.js"></script>  
    <script type="text/javascript" src="movieList.js"></script>  
    <script type="text/javascript" src="cincity.js"></script>  
  </body>
</html>